{% load staticfiles %}
<!DOCTYPE html>
{%load staticfiles %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900"
      rel="stylesheet"
    />
    <title>Newspaper App</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="{% static 'css/open-iconic-bootstrap.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'css/animate.css' %}" />

    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'css/owl.theme.default.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}" />

    <link rel="stylesheet" href="{% static 'css/aos.css' %}" />

    <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}" />

    <link rel="stylesheet" href="{% static 'css/flaticon.css' %}" />
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <script
      src="https://kit.fontawesome.com/0b40333001.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <nav
      class="navbar px-md-0 navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light"
      id="ftco-navbar"
    >
      <div class="container">
        <a href="{% url 'home' %}" class="navbar-brand">
          <img src="{% static 'images/live-news.png' %}" height="40px" alt="" />
        </a>

        <a class="navbar-brand" href="{% url 'home' %}">News24</a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#ftco-nav"
          aria-controls="ftco-nav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="oi oi-menu"></span> Menu
        </button>
        <!-- <form method="GET" class="form-inline my-2 my-lg-0 navbar-link" action="">
        {% csrf_token %}
        <input class="form-control " type="text" placeholder="Search" aria-label="Search" name="data"
          style="width:70%; height: 5%;" />
        <button class="btn btn-success  my-sm-0 p-1 m-2" type="submit">
          Search
        </button>
      </form> -->
        <div class="collapse navbar-collapse" id="ftco-nav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item" id="home">
              <a href="{% url 'home' %}" class="nav-link">Home</a>
            </li>
            <li class="nav-item">
              <div class="dropdown nav-link">
                <a
                  class="dropdown-toggle ml-1"
                  type="button"
                  id="dropdownMenuButton"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  Category
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  {% for category in categories %}
                  <a
                    class="dropdown-item"
                    href="{% url 'category' category.id %}"
                    >{{category.name}}</a
                  >
                  {% endfor %}
                </div>
              </div>
            </li>
            <li class="nav-item" id="articles">
              <a href="{% url 'article:list' %}" class="nav-link">Articles</a>
            </li>
            <li class="nav-item" id="team">
              <a href="{% url 'about' %}" class="nav-link">Team</a>
            </li>
            <li class="nav-item" id="contact">
              <a href="{% url 'contact' %}" class="nav-link">Contact</a>
            </li>
            <li class="nav-item navbar-brand">
              <a href="{% url 'articles:search' %}" class="nav-link">
                <img
                  src="{% static 'images/search.png'%}"
                  height="30px"
                  alt=""
                />
              </a>
            </li>
            {% if user.is_authenticated %}
            <li class="nav-item">
              <div class="nav-link mr-2 text-uppercase font-weight-bold">
                Welcome
              </div>
            </li>
            <li class="nav-item">
              <div class="dropdown mr-1">
                <button
                  class="btn btn-secondary dropdown-toggle mr-sm-3 my-2 p-1"
                  type="button"
                  id="dropdownMenuButton"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <i class="fas fa-arrow-circle-down"></i>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="{% url 'article:create' %}"
                    >Add Article</a
                  >
                </div>
              </div>
            </li>
            <li class="nav-item">
              <a
                class="nav-link btn btn-info text-white"
                href="javascript:{gotoLogout()}"
                >Logout</a
              >
              <form
                id="logout"
                action="{% url 'account_logout' %}"
                method="POST"
              >
                {% csrf_token %}
                <input type="hidden" />
              </form>
            </li>
            <li class="nav-item">
              <a
                href="{% url 'articles:feed'%}"
                class="nav-link ml-4 font-weight-bold text-white p-1"
              >
                <img src="{% static 'images/rss.png'%}" alt="" height="30px" />
              </a>
            </li>
            {% else %}
            <li class="nav-item mr-1">
              <a
                class="nav-link btn btn-success text-white"
                href="{% url 'account_login' %}"
                >Login</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link btn ml-1 btn-primary text-white"
                href="{% url 'account_signup' %}"
                >Register</a
              >
            </li>
            {% endif %}
          </ul>
        </div>
        <!-- <div class="collapse navbar-collapse" id="ftco-nav">
        <ul class="navbar-nav ml-auto">

        </ul>
      </div> -->
      </div>
    </nav>
    <div
      class="hero-wrap js-fullheight"
      style="background-image: url('static/images/bg_1.jpg');"
      data-stellar-background-ratio="0.5"
    >
      <div class="overlay"></div>
      <div class="container">
        <div
          class="row no-gutters slider-text js-fullheight align-items-center justify-content-start"
          data-scrollax-parent="true"
        >
          <div class="col-md-12 ftco-animate">
            <h2 class="subheading">Hello! Welcome to</h2>
            <h1 class="mb-4 mb-md-0">News24</h1>
            <div class="row">
              <div class="col-md-7">
                <div class="text">
                  <p>
                    Far far away, behind the word mountains, far from the
                    countries Vokalia and Consonantia, there live the blind
                    texts. Separated they live in Bookmarksgrove right at the
                    coast of the Semantics, a large language ocean.
                  </p>
                  <div class="mouse">
                    <a href="#section" class="mouse-icon">
                      <div class="mouse-wheel">
                        <span class="ion-ios-arrow-round-down"></span>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
      <div class="container">
        <div class="row text-center">
      <h1 class="mb-5 mt-5 font-weight-bold">Latest News</h1>
      </div>
    </div>

    <!-- <h1>Latest Articles</h1> -->
    <div id="image-list">
      {% include "pages/list_ajax.html" %}
    </div>
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <link
      rel="stylesheet"
      href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
    <script src="{% static 'js/jquery-migrate-3.0.1.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/jquery.stellar.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'js/aos.js' %}"></script>
    <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
    <script src="{% static 'js/scrollax.min.js' %}"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
    <script src="{% static 'js/google-map.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script type="text/javascript">
      function gotoLogout() {
        // console.log("logout worked!! ");
        document.getElementById("logout").submit();
      }
    </script>
    <script>
      var csrftoken = Cookies.get("csrftoken");
      function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return /^(GET|HEAD|OPTIONS|TRACE)$/.test(method);
      }
      $.ajaxSetup({
        beforeSend: function (xhr, settings) {
          if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
        },
      });

      $(document).ready(function () {
        var page = 1;
        var empty_page = false;
        var block_request = false;
        $(window).scroll(function () {
          var margin = $(document).height() - $(window).height() - 200;
          if (
            $(window).scrollTop() > margin &&
            empty_page == false &&
            block_request == false
          ) {
            block_request = true;
            page += 1;
            $.get("?page=" + page, function (data) {
              if (data == "") {
                empty_page = true;
              } else {
                block_request = false;
                $("#image-list").append(data);
              }
            });
          }
        });
      });
    </script>
  </body>
</html>
<!-- <section class="ftco-section" id="section">
  <div class="container">
    <div class="row text-center">
      <h1 class="mb-5 font-weight-bold">Popular News</h1>
    </div>
    <hr />
    <div class="row">
      <div class="col-md-12">
        {% for article in articles %}
        <div class="case">
          <div class="row">
            <div class="col-md-6 col-lg-6 col-xl-8 d-flex">
              <a href=" {% url 'article:details' article.id %}">
                <img src="{{article.image.url}}" class="img w-100 mb-3 mb-md-0" />
              </a>
            </div>
            <div class="col-md-6 col-lg-6 col-xl-4 d-flex">
              <div class="text w-100 pl-md-3">
                <span class="subheading">{{article.category.name}}</span>
                <h2><a href="{% url 'article:details' article.id %}">{{article.title}}</a></h2>
                {% if article.author == request.user %}
                <ul class="media-social list-unstyled">
                  <li class="ftco-animate">
                    <a
                      href="{% url 'article:edit' article.id %}"
                      class="p-2"
                      style="width: 80px;"
                      >Edit
                    </a>
                  </li>
                  <li class="ftco-animate">
                    <a
                      href="{% url 'article:delete' article.id %}"
                      class="p-1"
                      style="width: 80px;"
                      >Delete</a
                    >
                  </li>
                </ul>
                {% endif %}

                <div class="meta">
                  <p class="mb-0"><a>{{article.pub}}</a> | 
                    <a>{{article.countWords}}</a>
                  </p>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    <div class="row mt-5">
      <div class="col text-center">
        <div class="block-27">
          <ul class="pagination float-right">
         {% if page_obj.paginator.num_pages %}
        <li class="current page-item p-2">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </li>
        {% endif %}    
        {% if page_obj.has_previous %}

          <a href="?page=1" class="page-link">&laquo; first</a>

        
          <a href="?page={{ page_obj.previous_page_number }}" class="page-link"
            >previous</a
          >

        {% endif %} 
        
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="page-link"
          >next</a
        >
        <a href="?page={{ page_obj.paginator.num_pages }}" class="page-link"
          >last &raquo;</a
        >
        {% endif %}
      </ul>
        </div>
      </div>
    </div>
  </div>
</section> -->
